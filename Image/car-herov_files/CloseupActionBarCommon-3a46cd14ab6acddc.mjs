(self.modernJsonp=self.modernJsonp||[]).push([["55759"],{107056:function(e,t,n){n.r(t),n.d(t,{default:()=>R});var i=n(667294),o=n(312048),r=n(235045),a=n(550368),s=n(664659),l=n(996079),d=n(166988),c=n(77957),u=n(746868),p=n(470205),h=n(935059),m=n(501010),g=n(765603),x=n(774838),y=n(341687),f=n(200619),v=n(601871),C=n(15392),j=n(113759),b=n(632492),w=n(510755),P=n(504727),S=n(9065),_=n(785893);let k=(0,S.Z)(()=>Promise.all([n.e("25418"),n.e("96988"),n.e("63529"),n.e("64701")]).then(n.bind(n,53867)),void 0,e=>53867,"SaveAffordance",e=>["25418","96988","63529","64701"]),T=(0,S.Z)(()=>n.e("73301").then(n.bind(n,569369)),void 0,e=>569369,"PostDownloadUpsellPopover",e=>["73301"]),I=(0,S.Z)(()=>Promise.resolve().then(n.bind(n,53347)),void 0,e=>53347,"SecondarySendButtonCommon",e=>[]),Z=(0,S.Z)(()=>Promise.all([n.e("25418"),n.e("96415")]).then(n.bind(n,872901)),void 0,e=>872901,"ReactionPickerContainer",e=>["25418","96415"]),D=(0,S.Z)(()=>n.e("8419").then(n.bind(n,391728)),void 0,e=>391728,"CloseupCommentButton",e=>["8419"]),A=(0,S.Z)(()=>n.e("12447").then(n.bind(n,683827)),{ssr:!1},e=>683827,"SharePinHoverContent",e=>["12447"]),B=({ref:e})=>{e.current&&(clearTimeout(e.current),e.current=null)},R=function({goBack:e,gridDescription:t,isDeletedStoryPin:n,inCommentsImprovedDropdownExp:S,inCommentsPopoverExp:R,isEligibleForAggregatedComments:E,isEligibleForPinReactions:M,isOnSecretBoard:L,onEditSubmit:z,pin:H,viewParameter:O,viewType:F,onSaveButtonClick:U,showRepinOnInitialRender:W,isStoryPin:G,actionBarContainerRef:Y,outerPaddingSize:K=C.g9,maxWidth:J,showLeadPin:q,scrollContainerRef:N}){let $=(0,o.TH)(),X=(0,f.Z)(),{checkExperiment:Q}=(0,m.Z)(),{showEnabledSaveBehavior:V}=(0,P.Yh)(!0),{imgSrc:ee}=(0,c.G)(),{clientTrackingParams:et,showCloseupContentRight:en,closeupWithinMasonryEnabled:ei,peekCloseupEnabled:eo}=(0,j.x4)(),{viewType:er,viewParameter:ea}=(0,u.SU)(),es=(0,h.Z)(),el=(0,v.q6)(es,H?.pinner?.id,X),ed=(0,d.Z)({showProductDetailPage:!!H.is_eligible_for_pdp}),ec=(0,i.useRef)(null),eu=(0,i.useRef)(null),ep=(0,i.useRef)(null),[eh,em]=(0,i.useState)(!!(0,y.Z)($.search).share),[eg,ex]=(0,i.useState)(!1),[ey,ef]=(0,i.useState)(!1),[ev,eC]=(0,i.useState)(!1),{shareFromPostDownloadUpsell:ej,setShareFromPostDownloadUpsell:eb,saveToBoardFromPostDownloadUpsell:ew,setSaveToBoardFromPostDownloadUpsell:eP}=(0,a.tS)();ej&&(em(!0),eb(!1));let eS=(0,i.useCallback)(e=>ex(e),[]),e_=(0,i.useCallback)(()=>em(!1),[]),ek=(0,i.useCallback)(()=>em(e=>!e),[]),eT=(0,i.useCallback)(()=>{B({ref:ec}),B({ref:eu}),eu.current=setTimeout(()=>{ef(!0)},1e3)},[]),eI=(0,i.useCallback)(()=>{B({ref:ec}),B({ref:eu}),ec.current=setTimeout(()=>{ef(!1),ec.current=null},300)},[]),eZ=H.board?.owner?.id||H.pinner?.id,{aggregated_pin_data:eD,comments_disabled:eA,reaction_counts:eB}=H,{isRTL:eR}=(0,x.B)(),eE=ei?J:J||C.Gg,eM=(0,l.Z)({pinKey:{type:"Legacy",data:H},orbacActingAs:X,viewer:es}),eL=!!Object.keys(eB||{}).length,ez=eD?.did_it_data?.images_count??0,eH=(eD?.comment_count??0)+ez,eO=ep.current&&Q("ce_dweb_pin_rep_preview_on_share_icon_hover").anyEnabled&&!eh&&ey;(0,i.useEffect)(()=>{if(eO){let e=requestAnimationFrame(()=>eC(!0));return()=>cancelAnimationFrame(e)}eC(!1)},[eO]);let eF=L||n?null:(0,_.jsxs)(p.Z,{name:"CloseupActionBar_SecondarySendButton",children:[(0,_.jsx)(I,{anchorRef:ep,closeupWithinMasonryEnabled:ei,controllerOptions:{flyoutDisplayOptions:ei?{shownWithinProfileHeader:!0,idealDirection:"down",forceDirection:!0}:{wrapperPosition:"fixed"},isFlyoutOpen:eh,loggingOptions:{component:194,element:72,viewParameter:O||ea,viewType:F||er},onFlyoutDismiss:e_,onToggleFlyout:ek,sendObject:{type:"pin",description:t,id:H.id,imageUrl:ee,ownerId:eZ,url:`/pin/${H.id}/`,clientTrackingParams:et}},experienceAnchor:3025,onMouseEnter:eT,onMouseLeave:eI,shouldHideTooltip:!!eO,showSendAnimation:!0}),eO&&(0,_.jsx)(r.xu,{dangerouslySetInlineStyle:{__style:{opacity:+!!ev,transition:"opacity 300ms ease-out"}},onMouseEnter:eT,onMouseLeave:eI,children:(0,_.jsx)(r.J2,{anchor:ep.current,idealDirection:"down",offset:4,onDismiss:()=>{},size:"flexible",children:(0,_.jsx)(r.iP,{onTap:ek,children:(0,_.jsx)(p.Z,{name:"CloseupActionBar_SharePinHoverContent",children:(0,_.jsx)(A,{pin:H})})})})})]}),eU=(0,_.jsx)(r.xu,{alignItems:"center",color:ei?"transparent":"default","data-test-id":"closeup-action-items",display:"flex",justifyContent:"between",maxWidth:eE,role:"list",rounding:200,children:(0,_.jsxs)(r.kC,{alignItems:"stretch",gap:2*!!ei,justifyContent:"start",children:[!el&&!!M&&(0,_.jsx)(p.Z,{name:"CloseupActionBar_ReactionPickerContainer",children:(0,_.jsxs)(r.xu,{alignItems:"center",display:"flex",marginEnd:2*!!eL,role:"listitem",children:[(0,_.jsx)(Z,{clientTrackingParams:et,handleReactionTrayHover:eS,idealDirection:ei?"down":void 0,pinId:H.id,reactionByMe:H.reaction_by_me,showTooltip:!0,viewParameter:O,viewType:F}),(0,_.jsx)(g.Z,{pinId:H.id,reactionCounts:eB,showPrettyNumber:!0})]})}),ei&&!(S&&eA)&&(0,_.jsx)(D,{inCommentsImprovedDropdownExp:!!S,inCommentsPopoverExp:!!R,isEligibleForAggregatedComments:!!E,pinKey:{type:"Legacy",data:H},scrollContainerRef:N,shouldShowCommentCount:!eA&&!!eH&&(!!R||!!S),totalCommentCount:eH,viewParameter:O,viewType:F}),(0,_.jsx)(r.xu,{role:"listitem",children:eF}),(0,_.jsx)(r.xu,{"data-test-id":"closeup-more-options",role:"listitem",children:(0,_.jsx)(s.Z,{carouselSlotCurrentIndex:H&&H.carousel_data&&H.carousel_data.index,clientTrackingParams:et,closeupWithinMasonryEnabled:ei,goBack:e,isReactionTrayOpen:eg,onEditSubmit:z,pinKey:{type:"Legacy",data:H},showEditPin:!n&&eM,viewParameter:O,viewType:F})})]})}),eW=ei?void 0:K,eG=(0,_.jsxs)(r.xu,{ref:Y,color:"default",dangerouslySetInlineStyle:{__style:{paddingTop:K/2,paddingRight:eR?void 0:eW,paddingLeft:eR?eW:void 0,paddingBottom:ei?K/2:void 0,borderRadius:G?"0px 32px 32px 32px":en?"0px 32px 32px 0":void 0}},"data-test-id":"closeup-body-sticky-content",marginTop:ei?0:G?-5:0,width:ei?"100%":void 0,children:[(0,_.jsx)(r.xu,{"data-test-id":"closeupActionBar",marginStart:ed?-3:void 0,children:(0,_.jsxs)(r.kC,{alignItems:"stretch",justifyContent:"between",children:[eU,(0,_.jsx)(r.kC,{alignItems:"center",gap:2,children:!n&&!el&&(0,_.jsx)(r.xu,{marginStart:3*!ei,children:(0,_.jsx)(k,{boardCount:es.isAuth?es.boardCount:0,clientTrackingParams:et,onClickCallback:U,pinKey:{type:"Legacy",data:H},saveToBoardFromPostDownloadUpsell:ew,setSaveToBoardFromPostDownloadUpsell:eP,showEnabledSaveBehavior:V,showRepinOnInitialRender:W,variant:"closeup",viewParameter:O,viewType:F})})})]})}),(0,_.jsx)(T,{})]});if(q||ei)return eG;let eY=G&&!eo?w.cI+4:w.hu;return eo&&(eY=0),(0,_.jsx)(r.Le,{top:eY,zIndex:b.mS,children:eG})}},765603:function(e,t,n){n.d(t,{Z:()=>x});var i=n(667294),o=n(235045),r=n(361004),a=n(104999),s=n(24246),l=n(507006),d=n(729586),c=n(518596),u=n(825605),p=n(785893);function h(e,t,n){var i;return(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let m=(0,i.lazy)(()=>n.e("25993").then(n.bind(n,581897)));class g extends i.PureComponent{constructor(...e){super(...e),h(this,"state",{displayAggregationModal:!1}),h(this,"showAggregationModal",()=>{let{disableModal:e,logContextEvent:t}=this.props;e||(this.setState({displayAggregationModal:!0}),t({event_type:101,view_type:3,view_parameter:139,component:13458,element:11435,aux_data:{objectId:this.props.pinId}}))}),h(this,"hideAggregationModal",()=>{this.setState({displayAggregationModal:!1})})}render(){let{displayAggregationModal:e}=this.state,{isBold:t,isStoryPin:n,paddingY:i,pinId:a,reactionCounts:s,showPrettyNumber:h,size:g}=this.props,x=s?(0,c.At)(s):null,y=s?(0,c.Ud)(s):0,f=!!x&&x.length>0&&x.filter(e=>!!d.GY[e]).map((e,t)=>{let n=e&&d.GY[e]?d.GY[e]:"",{label:i,gridAsset:r}=(0,d.fW)(n,this.props.i18n);return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{marginRight:2}},children:(0,p.jsx)(o.xu,{height:19,width:19,children:r&&(0,p.jsx)(o.Ee,{alt:i??"",fit:"cover",naturalHeight:1,naturalWidth:1,src:r})})},t)});return(0,p.jsxs)(o.xu,{children:[(0,p.jsx)(o.iP,{accessibilityLabel:`${y} reactions`,dataTestId:"reactions-count-button",onTap:this.showAggregationModal,children:!!f&&(0,p.jsx)(o.xu,{"data-test-id":"aggregated-reactions-container",display:"inlineBlock",children:h?(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},children:(0,p.jsx)(o.xe,{size:g??r.n,weight:"bold",children:(0,p.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})}):(0,p.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"pointer"}},"data-test-id":"aggregated-reactions-container",direction:"row",display:"flex",height:n?"auto":19,paddingY:i??6*!n,children:[(0,p.jsx)(o.kC,{alignItems:"stretch",direction:"row",justifyContent:"start",children:f}),(0,p.jsx)(o.xu,{paddingX:1,children:(0,p.jsx)(o.xe,{color:t?"default":"subtle",size:g??r.n,weight:t?"bold":"normal",children:(0,p.jsx)(l.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:y})})})]})})}),e&&y&&(0,p.jsx)(u.Z,{children:(0,p.jsx)(m,{aggregatedReactions:f,onDismiss:this.hideAggregationModal,pinId:a,totalReactionCount:y})})]})}}h(g,"defaultProps",{isBold:!0});let x=function(e){let t=(0,s.Z)(),n=(0,a.Z)();return(0,p.jsx)(g,{...e,i18n:t,logContextEvent:n})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/CloseupActionBarCommon-3a46cd14ab6acddc.mjs.map